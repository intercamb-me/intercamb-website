<div id="task">
  <div class="modal-header px-4">
    <h4 class="modal-title">{{ task.name }}</h4>
    <button (click)="close()" type="button" class="close" aria-label="Close">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body px-4 py-4">
    <div class="d-flex">
      <div class="flex-grow-1 mr-4">
        <div class="mb-3">
          <span *ngIf="task.comments.length > 0" class="badge badge-secondary"><i class="far fa-comment"></i> {{ task.comments.length }}</span>
          <span *ngIf="task.attachments.length > 0" class="badge badge-secondary"><i class="fas fa-paperclip"></i> {{ task.attachments.length }}</span>
          <span *ngIf="task.status === 'scheduled'" class="badge badge-orange"><i class="far fa-clock"></i> {{ task.properties.schedule_date | date: "dd 'de' MMMM 'de' yyyy 'às' HH:mm" }}</span>
        </div>
        <div class="mb-3">
          <h5>Arquivos</h5>
          <div *ngIf="task.attachments.length === 0" class="jumbotron py-5 mb-0 text-center">
            <p class="mb-0">Nenhum arquivo</p>
          </div>
        </div>
        <div class="comments">
          <h5>Comentários</h5>
          <textarea [(ngModel)]="comment" (keypress)="onCommentKeyPress($event)" (keyup)="onCommentKeyUp($event)" class="form-control mb-3" name="comment" [rows]="commentRows" placeholder="Deixe um comentário..."></textarea>
          <div *ngIf="task.comments.length === 0" class="jumbotron py-5 mb-0 text-center">
            <p class="mb-0">Nenhum comentário</p>
          </div>
          <div *ngFor="let comment of task.comments.slice().reverse(); trackBy: trackByComment" class="comment">
            <div class="icon">
              <img *ngIf="accounts.get(comment.account)" [src]="accounts.get(comment.account).icon_url">
            </div>
            <div class="balloon">
              <p *ngIf="accounts.get(comment.account)" class="author">{{ accounts.get(comment.account).name }}</p>
              <p class="text">{{ comment.text }}</p>
            </div>
          </div>
        </div>
      </div>
      <div class="flex-shrink-0 d-flex flex-column justify-content-start">
        <button (click)="openChangeStatus(task)" type="button" class="btn btn-{{ taskStatus[task.status].selector }}">{{ taskStatus[task.status].name }}</button>
        <label class="btn btn-primary btn-file mt-2">
          <i class="fas fa-paperclip"></i> Anexar arquivo
          <input (change)="postFile($event)" type="file" name="file" accept="*/*">
        </label>
      </div>
    </div>
  </div>
</div>